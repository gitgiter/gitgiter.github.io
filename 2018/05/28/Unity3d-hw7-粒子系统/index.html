<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Unity3d-hw7-粒子系统 | gitgiter&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Unity3d实战之粒子系统选题要求参考 http://i-remember.fr/en 这类网站，使用粒子流编程控制制作一些效果， 如“粒子光环” 实现效果 静态图 动态图  知识准备粒子系统有许多大模块，比如最常用的有初始化模块、发射模块、粒子群形状模块，颜色随存活时间、速度变化的模块等。这里重点学习了一下最重要的初始化模块中各个参数的作用。|参数|功能||:—:|:—:||持续时间（Dura">
<meta name="keywords" content="Unity3d">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity3d-hw7-粒子系统">
<meta property="og:url" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/index.html">
<meta property="og:site_name" content="gitgiter&#39;s blog">
<meta property="og:description" content="Unity3d实战之粒子系统选题要求参考 http://i-remember.fr/en 这类网站，使用粒子流编程控制制作一些效果， 如“粒子光环” 实现效果 静态图 动态图  知识准备粒子系统有许多大模块，比如最常用的有初始化模块、发射模块、粒子群形状模块，颜色随存活时间、速度变化的模块等。这里重点学习了一下最重要的初始化模块中各个参数的作用。|参数|功能||:—:|:—:||持续时间（Dura">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/scene.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/GIF.gif">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step1.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step1_2.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step2.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step3_1.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step3_2.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step4.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/step6.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/edge.png">
<meta property="og:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/NoEdge.png">
<meta property="og:updated_time" content="2018-06-23T16:37:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity3d-hw7-粒子系统">
<meta name="twitter:description" content="Unity3d实战之粒子系统选题要求参考 http://i-remember.fr/en 这类网站，使用粒子流编程控制制作一些效果， 如“粒子光环” 实现效果 静态图 动态图  知识准备粒子系统有许多大模块，比如最常用的有初始化模块、发射模块、粒子群形状模块，颜色随存活时间、速度变化的模块等。这里重点学习了一下最重要的初始化模块中各个参数的作用。|参数|功能||:—:|:—:||持续时间（Dura">
<meta name="twitter:image" content="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/scene.png">
  
    <link rel="alternate" href="/atom.xml" title="gitgiter&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">gitgiter&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Unity3d-hw7-粒子系统" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/28/Unity3d-hw7-粒子系统/" class="article-date">
  <time datetime="2018-05-27T17:39:42.000Z" itemprop="datePublished">2018-05-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Unity3d-hw7-粒子系统
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Unity3d实战之粒子系统"><a href="#Unity3d实战之粒子系统" class="headerlink" title="Unity3d实战之粒子系统"></a>Unity3d实战之粒子系统</h1><h2 id="选题要求"><a href="#选题要求" class="headerlink" title="选题要求"></a>选题要求</h2><p>参考 <a href="http://i-remember.fr/en" target="_blank" rel="noopener">http://i-remember.fr/en</a> 这类网站，使用粒子流编程控制制作一些效果， 如“粒子光环”</p>
<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><ul>
<li>静态图<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/scene.png" alt=""></li>
<li>动态图<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/GIF.gif" alt=""></li>
</ul>
<h2 id="知识准备"><a href="#知识准备" class="headerlink" title="知识准备"></a>知识准备</h2><p>粒子系统有许多大模块，比如最常用的有初始化模块、发射模块、粒子群形状模块，颜色随存活时间、速度变化的模块等。这里重点学习了一下最重要的初始化模块中各个参数的作用。<br>|参数|功能|<br>|:—:|:—:|<br>|持续时间（Duration）|粒子系统发射粒子的持续时间|<br>|循环（Looping）|粒子系统是否循环|<br>|预热（Prewarm）|当looping开启时，才能启动预热（Prewarm），游戏开始时粒子已经发射了一个周期|<br>|初始延迟（Start Delay）|粒子系统发射粒子之前的延迟。注意在prewarm（预热）启用下不能使用此项|<br>|初始生命（Start Lifetime）|以秒为单位，粒子存活数量|<br>|初始速度（Start Speed）|粒子发射时的速度|<br>|初始大小（Start Size）|粒子发射时的大小|<br>|初始旋转（Start Rotation）|粒子发射时的旋转值|<br>|初始颜色（Start Color）|粒子发射时的颜色|<br>|重力修改器（Gravity Modifier）|粒子在发射时受到的重力影响|<br>|继承速度（Inherit Velocity）|控制粒子速率的因素将继承自粒子系统的移动（对于移动中的粒子系统）|<br>|模拟空间（Simulation Space）|粒子系统在自身坐标系还是世界坐标系|<br>|唤醒时播放（Play On Awake）|如果启用粒子系统当在创建时，自动开始播放|<br>|最大粒子数（Max Particles）|粒子发射的最大数量|</p>
<h2 id="思路确定"><a href="#思路确定" class="headerlink" title="思路确定"></a>思路确定</h2><p>对 <a href="http://i-remember.fr/en" target="_blank" rel="noopener">http://i-remember.fr/en</a> 上的例子进行了一定的学习后，最后打算做一些改进和创新，利用其原理实现一个卫星带，再用这个卫星带实现一个卫星带围绕行星转的效果。详细过程请见实现步骤。</p>
<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><ul>
<li>第一步，新建一个空对象StarRing，注意将其位置设置成（0，0，0），然后添加一个粒子系统的组件，叫ParticleSystem，组建里面的各种参数先不用改动，<strong>推荐通过代码来修改</strong>，可以批量修改，方便快捷而且有利于团队合作、给别人参考等方面。如果直接在组件里改，其他人每次都需要加载对应的场景才看得到修改的参数，而且粒子系统参数众多，这样也不能很直观地看出修改了哪些参数。因此还是推荐写在代码里。<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step1.png" alt=""><br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step1_2.png" alt=""></li>
<li>第二步，从上一步可以看出，最开始默认的粒子似乎出现了材质丢失的情况，可能是因为<strong>新老版本材质球不兼容</strong>的原因导致的，也正好，我们可以自己找一些想要的材质，将其拖到承载ParticleSystem的对象上，就完成了对粒子的贴图。我在网上找了一张土壤表面的材质，大致充当一些小卫星的样子（拉近看可能效果没那么好）<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step2.png" alt=""></li>
<li>第三步，为了匹配星空的背景，原来这样的默认背景肯定是不合适的，无法营造出那种效果。因此要将天空盒改成纯黑色的模仿宇宙中的光吞噬。更改步骤是上面菜单栏Window-&gt;Lighting-&gt;Settings-&gt;Skybox Material的材质改成黑色的即可，这里我是改成Defualt Material。<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step3_1.png" alt=""><br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step3_2.png" alt=""></li>
<li>第四步，创建一个球体Star，贴上木星贴图，充当大行星，位置设置在（0，0，0），位于粒子群中心，并让其自转，目的是模仿木星环围绕着木星转的情景，这里就没有设置木星的公转了，涉及到镜头跟随等其他一系列操作，不是这次作业的主要重点。<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step4.png" alt=""></li>
<li><p>第五步，添加一个c#脚本，挂载到Star上，来控制Star的自转。这个代码只需要在update中添加如下代码，即可实现自转，相关原理有在之前的太阳系作业中学习过，这里就算是巩固复习了。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.transform.Rotate(Vector3.up * <span class="number">30</span> * Time.deltaTime);</span><br></pre></td></tr></table></figure>
</li>
<li><p>第六步，添加一个c#脚本，用来挂载到StarRing上，开始主要代码的编写，实现对粒子系统的控制。<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/step6.png" alt=""></p>
</li>
<li><p>第七步，为方便起见，创建一个类，来记录每个粒子所应该具有的基本信息。这样有利于提升代码<strong>美观度</strong>，<strong>可读性</strong>，也使得可<strong>扩展性</strong>大大增强，如果往后需要给每个粒子加基本属性信息的话，只需要在类中加一个成员，不用大幅度改动重要代码。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ParticleInfo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> radius = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> angle = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ParticleInfo</span>(<span class="params"><span class="keyword">float</span> radius, <span class="keyword">float</span> angle</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.radius = radius;   <span class="comment">// 半径  </span></span><br><span class="line">        <span class="keyword">this</span>.angle = angle;     <span class="comment">// 角度  </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第八步，确定并添加和粒子系统初始化及管理有关的成员变量。成员变量应该<strong>越简越好</strong>，防止成员冗余造成额外的空间开销。这里其实最重要的就是前面三个成员变量，分别是粒子系统、粒子数组以及粒子信息数组。<strong>粒子系统</strong>就是大Boss，<strong>粒子数组</strong>主要是用来更细致地定义每个粒子的属性，最后可以通过粒子数组来设置粒子系统。而<strong>粒子信息数组</strong>则更多地扮演着一个对每个粒子信息进行统一集成和管理的角色，存储着随机生成的粒子半径和角度，可以用来计算每个粒子的位置，已确定粒子数组中每个元素的position。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ParticleSystem particleSys;  <span class="comment">// 粒子系统  </span></span><br><span class="line"><span class="keyword">private</span> ParticleSystem.Particle[] particleArr;  <span class="comment">// 粒子数组  </span></span><br><span class="line"><span class="keyword">private</span> ParticleInfo[] info; <span class="comment">// 粒子信息数组  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> speed = <span class="number">0.25</span>f;            <span class="comment">// 速度    </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> count = <span class="number">8000</span>;       <span class="comment">// 粒子数量</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第九步，初始化粒子系统。主要是要申请两个重要数组，以及设置整个粒子系统的初始速度和最大粒子量。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化粒子数组  </span></span><br><span class="line">    particleArr = <span class="keyword">new</span> ParticleSystem.Particle[count];</span><br><span class="line">    info = <span class="keyword">new</span> ParticleInfo[count];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化粒子系统  </span></span><br><span class="line">    particleSys = <span class="keyword">this</span>.GetComponent&lt;ParticleSystem&gt;();</span><br><span class="line">    particleSys.loop = <span class="literal">false</span>;              <span class="comment">// 取消粒子循环</span></span><br><span class="line">    particleSys.startSpeed = <span class="number">0</span>;            <span class="comment">// 设置粒子初速度      </span></span><br><span class="line">    particleSys.maxParticles = count;      <span class="comment">// 设置最大粒子量  </span></span><br><span class="line">    particleSys.Emit(count);               <span class="comment">// 发射粒子  </span></span><br><span class="line">    particleSys.GetParticles(particleArr);</span><br><span class="line"></span><br><span class="line">    IniAll();   <span class="comment">// 初始化所有粒子</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第十步，初始化所有粒子。这里主要随机产生一些粒子的信息，比如粒子半径，角度，大小等。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IniAll</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;                </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i)</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">// 随机每个粒子半径，集中于平均半径附近  </span></span><br><span class="line">        <span class="keyword">float</span> midRadius = <span class="number">8.0</span>f;</span><br><span class="line">        <span class="keyword">float</span> radius = Random.Range(midRadius - <span class="number">2</span>, midRadius + <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 随机每个粒子的角度  </span></span><br><span class="line">        <span class="keyword">float</span> angle = Random.Range(<span class="number">0</span>, <span class="number">360</span>);</span><br><span class="line">        <span class="comment">// 转换成弧度制</span></span><br><span class="line">        <span class="keyword">float</span> radian = angle / <span class="number">180</span> * Mathf.PI;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 随机每个粒子的大小</span></span><br><span class="line">        <span class="keyword">float</span> size = Random.Range(<span class="number">0.01</span>f, <span class="number">0.03</span>f);</span><br><span class="line"></span><br><span class="line">        info[i] = <span class="keyword">new</span> ParticleInfo(radius, angle);            </span><br><span class="line"></span><br><span class="line">        particleArr[i].position = <span class="keyword">new</span> Vector3(info[i].radius * Mathf.Cos(radian), <span class="number">0</span>f, info[i].radius * Mathf.Sin(radian));</span><br><span class="line">        particleArr[i].size = size;            </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过初始化好的粒子数组设置粒子系统</span></span><br><span class="line">    particleSys.SetParticles(particleArr, particleArr.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后一步！重写update方法，每帧刷新以实现粒子群移动的效果，对i模2是为了是粒子运动效果更加丰富，可以同时有顺时针和逆时针移动的粒子。但是在真实情况中卫星带中的小卫星旋转方向应该都是大致一致的，不然会出大事，这里主要是为了体验一下粒子系统强大运算能力的魅力。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 除以半径是为了使速度更加多样化</span></span><br><span class="line">        <span class="keyword">float</span> rotateSpeed = (speed / info[i].radius) * (i % <span class="number">10</span> + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 一半粒子顺时针转，一半粒子逆时针转</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            info[i].angle -= rotateSpeed;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            info[i].angle += rotateSpeed;</span><br><span class="line">        &#125;                </span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保证角度合法</span></span><br><span class="line">        info[i].angle %= <span class="number">360.0</span>f;</span><br><span class="line">        <span class="comment">// 转换成弧度制</span></span><br><span class="line">        <span class="keyword">float</span> radian = info[i].angle * Mathf.PI / <span class="number">180</span>;     </span><br><span class="line"></span><br><span class="line">        particleArr[i].position = <span class="keyword">new</span> Vector3(info[i].radius * Mathf.Cos(radian), <span class="number">0</span>f, info[i].radius * Mathf.Sin(radian));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过粒子数组设置粒子系统</span></span><br><span class="line">    particleSys.SetParticles(particleArr, particleArr.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>经历过之前的所有方法后，我们就可以把代码跑起来了，内心激动，但是一看效果，贼尬，卫星带边缘如此明显，看着极其不自然。<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/edge.png" alt=""></p>
</li>
<li>于是上网搜了搜柔滑边缘的方法，看到大神是这么处理的。巧妙地使用比例随机来柔滑边缘，一看似乎很有道理，决定参照模仿一下，效果惊人。主要改动如下：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IniAll</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;          </span><br><span class="line">    <span class="keyword">float</span> minRadius = <span class="number">6.0f</span>;  <span class="comment">// 最小半径  </span></span><br><span class="line">    <span class="keyword">float</span> maxRadius = <span class="number">10.0f</span>; <span class="comment">// 最大半径           </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i)</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">// 随机每个粒子半径，集中于平均半径附近  </span></span><br><span class="line">        <span class="keyword">float</span> midRadius = (maxRadius + minRadius) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">float</span> minRate = Random.Range(<span class="number">1.0f</span>, midRadius / minRadius);</span><br><span class="line">        <span class="keyword">float</span> maxRate = Random.Range(midRadius / maxRadius, <span class="number">1.0f</span>);</span><br><span class="line">        <span class="keyword">float</span> radius = Random.Range(minRadius * minRate, maxRadius * maxRate);</span><br><span class="line"></span><br><span class="line">        ...         </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过初始化好的粒子数组设置粒子系统</span></span><br><span class="line">    particleSys.SetParticles(particleArr, particleArr.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>改后效果：<br><img src="/2018/05/28/Unity3d-hw7-粒子系统/NoEdge.png" alt=""></p>
<ul>
<li>优化，采用类似的原理，可以让每个粒子在一个很小的位置范围内抖动，让画面更加真实带感，实现方法是在update方法中可以加入一下随机的偏移量。<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 粒子在半径方向上抖动           </span></span><br><span class="line">        <span class="keyword">float</span> offset = Random.Range(<span class="number">-0.01</span>f, <span class="number">0.01</span>f);  <span class="comment">// 偏移范围</span></span><br><span class="line">        info[i].radius += offset;</span><br><span class="line"></span><br><span class="line">        particleArr[i].position = <span class="keyword">new</span> Vector3(info[i].radius * Mathf.Cos(radian), <span class="number">0</span>f, info[i].radius * Mathf.Sin(radian));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过粒子数组设置粒子系统</span></span><br><span class="line">    particleSys.SetParticles(particleArr, particleArr.Length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>到此便和一开始展示的效果完全一致了。</p>
<hr>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>以上为个人理解，可能有误，仅供参考。</li>
<li>如感兴趣，可访问笔者Gayhub地址—<a href="(https://github.com/gitgiter/unity3d-learning/tree/master/homework7">传送门</a></li>
<li>视频演示地址—<a href="https://www.bilibili.com/video/av24039975/" target="_blank" rel="noopener">传送门</a></li>
<li>csdn博客地址—<a href="https://mp.csdn.net/mdeditor/80474739" target="_blank" rel="noopener">传送门</a></li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/28/Unity3d-hw7-粒子系统/" data-id="cjmde5kx5000cikq2deu3p7wa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity3d/">Unity3d</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/06/06/Unity3d-hw8-背包系统/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Unity3d-hw8-背包系统
        
      </div>
    </a>
  
  
    <a href="/2018/05/11/Unity3d-hw6-巡逻兵/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Unity3d-hw6-巡逻兵</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity3d/">Unity3d</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中级实训/">中级实训</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Unity3d/" style="font-size: 20px;">Unity3d</a> <a href="/tags/中级实训/" style="font-size: 10px;">中级实训</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/22/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2018/06/24/Unity3d-hw10-联机冰球对战/">Unity-hw10-联机冰球对战</a>
          </li>
        
          <li>
            <a href="/2018/06/19/Unity3d-hw9-AR小游戏/">Unity3d-hw9-AR小游戏</a>
          </li>
        
          <li>
            <a href="/2018/06/06/Unity3d-hw8-背包系统/">Unity3d-hw8-背包系统</a>
          </li>
        
          <li>
            <a href="/2018/05/28/Unity3d-hw7-粒子系统/">Unity3d-hw7-粒子系统</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 xie tao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>